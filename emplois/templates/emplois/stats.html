{% extends "base.html" %}
{% load i18n %}
{% load humanize %}

{% load staticfiles %}

	{% block content %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>

<link href="{% static "emplois/css/font-awesome.min.css" %}" rel="stylesheet"/>


	<link rel="stylesheet" href="{% static "emplois/css/cal-heatmap.css" %}" rel="stylesheet" />
<script type="text/javascript" src="{% static "emplois/js/cal-heatmap.min.js" %}"></script>

	<h1>{% trans "stats" %}</h1>

<button id="example-c-PreviousDomain-selector" style="margin-bottom: 10px;" class="btn btn-info"> 
	<i class="icon icon-chevron-left"></i>
</button>

<button id="example-c-NextDomain-selector" style="margin-bottom: 10px;" class="btn btn-info"> 
	<i class="icon icon-chevron-right"></i>
</button>

	</button>

<div id="example-d"></div>
<div id="onClick-placeholder">
    <p>&nbsp;</p>
    <p>&nbsp;</p>
</div>

{% get_current_language as LANGUAGE_CODE %}
<script type="text/javascript"> 
   var lang = "{{ LANGUAGE_CODE}}"
</script>
<script type="text/javascript">



var cal = new CalHeatMap();
cal.init({
	itemSelector: "#example-d",
	domain: "month",
	//subDomain: "month",
  itemName: ["job", "jobs"],
	data: {{ stats }},
	start: new Date(2015, 3),
	cellSize: 10,
	range: 15,
	legend: [1, 2, 4, 6],
	previousSelector: "#example-c-PreviousDomain-selector",
	nextSelector: "#example-c-NextDomain-selector",
    onClick: function(date, nb) {
    	console.log(date);
        //Add AJAX call for all the jobs for that date
        //Add cookie or variable for the language i18n
        /*
        $("#onClick-placeholder").html("You just clicked <br/>on <b>" +
            date + "</b> <br/>with <b>" +
            (nb === null ? "unknown" : nb) + "</b> jobs"
        );
*/
var jqxhr = $.ajax({
  method: "GET",
  url: "stats_emplois",
  data: { mois: 12, annee: 2015, jour:23, language: lang }
})
  .done(function(data) {
    console.log( data );
    //mettre les donn√©es
    //foreach
  })
  .fail(function() {
    console.log( "error" );
    //print error
  })
  .always(function() {
    console.log( "complete" );
  });

    }
});
</script>

	{% endblock %}
